<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>数据分析 | Numpy实战(一) - 分析某单车骑行时间 | Hello</title><meta name="author" content="sagonimikakokomi"><meta name="copyright" content="sagonimikakokomi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="数据分析 | Numpy实战(一) - 分析某单车骑行时间原创 煌金的咸鱼 咸鱼学Python 2018-12-24 11:04 思路整理咸鱼也是第一次动手写数据分析相关的代码，所以咸鱼上网找了一张大致的流程图，且以此整理思路，分隔代码。 图 | 源自网络 在企业实际开发中各个步骤的代码不会像咸鱼下面的代码一样各块分隔的那么清楚，肯定是相互交织且复杂的。  实战分析目的看标题就知道了，分析各季度共">
<meta property="og:type" content="article">
<meta property="og:title" content="数据分析 | Numpy实战(一) - 分析某单车骑行时间">
<meta property="og:url" content="https://kokomisukisuki.github.io/2023/10/10/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%20%20Numpy%E5%AE%9E%E6%88%98(%E4%B8%80)%20-%20%E5%88%86%E6%9E%90%E6%9F%90%E5%8D%95%E8%BD%A6%E9%AA%91%E8%A1%8C%E6%97%B6%E9%97%B4/index.html">
<meta property="og:site_name" content="Hello">
<meta property="og:description" content="数据分析 | Numpy实战(一) - 分析某单车骑行时间原创 煌金的咸鱼 咸鱼学Python 2018-12-24 11:04 思路整理咸鱼也是第一次动手写数据分析相关的代码，所以咸鱼上网找了一张大致的流程图，且以此整理思路，分隔代码。 图 | 源自网络 在企业实际开发中各个步骤的代码不会像咸鱼下面的代码一样各块分隔的那么清楚，肯定是相互交织且复杂的。  实战分析目的看标题就知道了，分析各季度共">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.helloimg.com/images/2023/10/03/oHxEPE.jpg">
<meta property="article:published_time" content="2023-10-09T16:00:00.000Z">
<meta property="article:modified_time" content="2023-10-10T12:44:21.393Z">
<meta property="article:author" content="sagonimikakokomi">
<meta property="article:tag" content="数据分析">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.helloimg.com/images/2023/10/03/oHxEPE.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://kokomisukisuki.github.io/2023/10/10/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%20%20Numpy%E5%AE%9E%E6%88%98(%E4%B8%80)%20-%20%E5%88%86%E6%9E%90%E6%9F%90%E5%8D%95%E8%BD%A6%E9%AA%91%E8%A1%8C%E6%97%B6%E9%97%B4/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"UNK1PFAIM3","apiKey":"82e2706c98842df0554f4f4c562132c7","indexName":"kokomisuki","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: sagonimikakokomi","link":"链接: ","source":"来源: Hello","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '数据分析 | Numpy实战(一) - 分析某单车骑行时间',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-10-10 20:44:21'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://ooo.0x0.ooo/2023/10/02/OnIWmL.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">124</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://www.helloimg.com/images/2023/10/04/oHLaXg.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Hello"><span class="site-name">Hello</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">数据分析 | Numpy实战(一) - 分析某单车骑行时间</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-09T16:00:00.000Z" title="发表于 2023-10-10 00:00:00">2023-10-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-10T12:44:21.393Z" title="更新于 2023-10-10 20:44:21">2023-10-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%A8%8B%E5%BA%8F/">程序</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="数据分析-Numpy实战-一-分析某单车骑行时间"><a href="#数据分析-Numpy实战-一-分析某单车骑行时间" class="headerlink" title="数据分析 | Numpy实战(一) - 分析某单车骑行时间"></a>数据分析 | Numpy实战(一) - 分析某单车骑行时间</h1><p>原创 煌金的咸鱼 <a href="javascript:void(0);">咸鱼学Python</a> <em>2018-12-24 11:04</em></p>
<h4 id="思路整理"><a href="#思路整理" class="headerlink" title="思路整理"></a>思路整理</h4><p>咸鱼也是第一次动手写数据分析相关的代码，所以咸鱼上网找了一张大致的流程图，且以此整理思路，分隔代码。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/jqCHqBaKLl21avaTr2pnseFQuSE1pAZKteoZLiba1AhldafZsl6Dkq1dwicMY6L9MMhMib3fF0eRj2EVbBZFpY8jA/640?wx_fmt=png&wxfrom=13&tp=wxpic" alt="图片">图 | 源自网络</p>
<p>在企业实际开发中各个步骤的代码不会像咸鱼下面的代码一样各块分隔的那么清楚，肯定是相互交织且复杂的。</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/jqCHqBaKLl21avaTr2pnseFQuSE1pAZKhoyfE4lPIc1934cuju1KzH7NNVzdbmFPECagtvrGhzOHicX1Bss1Hrw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<h4 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h4><h5 id="分析目的"><a href="#分析目的" class="headerlink" title="分析目的"></a>分析目的</h5><p>看标题就知道了，分析各季度共享单车的骑行时间。</p>
<h5 id="数据收集"><a href="#数据收集" class="headerlink" title="数据收集"></a>数据收集</h5><p>因为这次的数据源自网络，所以先简单看下数据的结构：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/jqCHqBaKLl21avaTr2pnseFQuSE1pAZKycZ9fmls1vLHT8EzZnn33rUVPGS64YibiarD6m5hfj8Jz916yupowKjQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>可以看到数据有9个字段：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Duration (ms)&quot;,&quot;Start date&quot;,&quot;End date&quot;,&quot;Start station number&quot;,&quot;Start station&quot;,&quot;End station number&quot;,&quot;End station&quot;,&quot;Bike number&quot;,&quot;Member type&quot;</span><br></pre></td></tr></table></figure>

<p>按照我们的目标，我们只需要第一个字段<code>Duration(ms)</code>。</p>
<p>所以第一步先读取已经下载好的数据之后在第二步数据清洗中取出需要的字段：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 数据收集</span><br><span class="line">def data_collection():</span><br><span class="line">    data_arr_list = []</span><br><span class="line">    for data_filename in data_filenames:</span><br><span class="line">        file = os.path.join(data_path, data_filename)</span><br><span class="line">        data_arr = np.loadtxt(file,dtype=bytes,delimiter=&#x27;,&#x27;, skiprows=1).astype(str)</span><br><span class="line">        data_arr_list.append(data_arr)</span><br><span class="line">    return data_arr_list</span><br></pre></td></tr></table></figure>

<p>这里关于numpy的用法，可以参考之前的几篇关于numpy的文章：</p>
<p><a target="_blank" rel="noopener" href="http://mp.weixin.qq.com/s?__biz=MzIwNDI1NjUxMg==&mid=2651261273&idx=2&sn=6a4f578765a000aef86b4174d9d638d4&chksm=8d314d36ba46c42030042f8028af5db5503939f95e7f3ae3690509a1d35d3ca3378eefba1f60&scene=21#wechat_redirect">Data Science | Numpy基础(一)</a></p>
<p><a target="_blank" rel="noopener" href="http://mp.weixin.qq.com/s?__biz=MzIwNDI1NjUxMg==&mid=2651261277&idx=1&sn=ac61ae450f673add03f4eff5320c2903&chksm=8d314d32ba46c424e74292d41d71cd3d5fa9bede8fa8cbdcc73298bd8c0362ed57615a2998c8&scene=21#wechat_redirect">Data Science | Numpy基础(二)</a></p>
<p><a target="_blank" rel="noopener" href="http://mp.weixin.qq.com/s?__biz=MzIwNDI1NjUxMg==&mid=2651261289&idx=1&sn=d3a13d63de01ca4ad528ca5c4d4f3fb2&chksm=8d314d06ba46c410b3d512fb70172c084a207718e1015d88730a1284e3412f58a4eb7d28bdc1&scene=21#wechat_redirect">Data Science | 福利列表 | Numpy基础(三)</a></p>
<h5 id="数据清洗"><a href="#数据清洗" class="headerlink" title="数据清洗"></a>数据清洗</h5><p>因为数据是整理后导出的数据所以不需要清洗缺失值等操作，我们直接取出需要的字段，做一些处理即可。</p>
<p>这里骑行时间单位为ms,所以需要转化为min需要&#x2F;1000&#x2F;60。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 数据清洗</span><br><span class="line">def data_clean(data_arr_list):</span><br><span class="line">    duration_min_list = []</span><br><span class="line">    for data_arr in data_arr_list:</span><br><span class="line">        data_arr = data_arr[:,0]</span><br><span class="line">        duration_ms = np.core.defchararray.replace(data_arr,&#x27;&quot;&#x27;,&#x27;&#x27;)</span><br><span class="line">        duration_min = duration_ms.astype(&#x27;float&#x27;) / 1000 / 60</span><br><span class="line">        duration_min_list.append(duration_min)</span><br><span class="line">    return duration_min_list</span><br></pre></td></tr></table></figure>

<h5 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h5><p>计算平均值在numpy中提供了计算函数，直接调用即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 数据分析</span><br><span class="line">def mean_data(duration_min_list):</span><br><span class="line">    duration_mean_list = []</span><br><span class="line">    for duration_min in duration_min_list:</span><br><span class="line">        duration_mean = np.mean(duration_min)</span><br><span class="line">        duration_mean_list.append(duration_mean)</span><br><span class="line">    return duration_mean_list</span><br></pre></td></tr></table></figure>

<h5 id="结果展示"><a href="#结果展示" class="headerlink" title="结果展示"></a>结果展示</h5><p>这里可视化展示使用的是matplotlib.pyplot库,咸鱼目前还没有写相关的入门文章，可以上网看下文档学习下简单使用即可，之后会有系列文章写可视化的内容。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 数据展示</span><br><span class="line">def show_data(duration_mean_list):</span><br><span class="line">    plt.figure()</span><br><span class="line">    name_list = [&#x27;第一季度&#x27;, &#x27;第二季度&#x27;, &#x27;第三季度&#x27;, &#x27;第四季度&#x27;]</span><br><span class="line">    plt.bar(range(len(duration_mean_list)),duration_mean_list,tick_label = name_list)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>

<h4 id="成果展示"><a href="#成果展示" class="headerlink" title="成果展示"></a>成果展示</h4><p><img src="https://mmbiz.qpic.cn/mmbiz_png/jqCHqBaKLl21avaTr2pnseFQuSE1pAZKKZAQJFCsrGZ7vR1Z5wiakD8wRym3TkzHarZNm0NOC68F9wibTppWYtmg/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>单单从上面的图可以看到以炎热的夏季和凉爽的秋季为主调的二三季度的骑行时间要高于春冬为主调的一四季度，以此判断气温变化对人们使用的共享单车的影响。</p>
<h4 id="一些踩过的坑"><a href="#一些踩过的坑" class="headerlink" title="一些踩过的坑"></a>一些踩过的坑</h4><h5 id="关于数据读取-一"><a href="#关于数据读取-一" class="headerlink" title="关于数据读取(一)"></a>关于数据读取(一)</h5><p>在python中字符串是有字节字符串和文本字符串之分的，我们通常说的字符串是指文本字符串。而使用numpy的loadtxt函数读取的字符串默认是字节字符串，输出的话字符串前面会有个b，形如b’……’。通常是需要转换的，如果不转换将会出现问题。</p>
<p>在<code>数据收集</code>部分如果不注意这一点，在<code>数据清洗</code>部分，字段的格式就会因为<code>Duration</code>的值多了一个<code>b</code>转化上就会报错。</p>
<p>处理方式：</p>
<blockquote>
<p>numpy.loadtxt读入的字符串总是bytes格式，总是在前面加了一个b<br>原因：np.loadtxt and np.genfromtxt operate in byte mode, which is the default string type in Python 2. But Python 3 uses unicode, and marks bytestrings with this b. numpy.loadtxt中也声明了：Note that generators should return byte strings for Python 3k.解决：使用numpy.loadtxt从文件读取字符串，最好使用这种方式np.loadtxt(filename, dtype&#x3D;bytes).astype(str)</p>
<p>作者：Cameron<br>链接：<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28690341/answer/164344688">https://www.zhihu.com/question/28690341/answer/164344688</a><br>来源：知乎</p>
</blockquote>
<h5 id="关于数据读取上的坑（二）"><a href="#关于数据读取上的坑（二）" class="headerlink" title="关于数据读取上的坑（二）"></a>关于数据读取上的坑（二）</h5><p>可以看到咸鱼在读取数据的时候使用的是numpy.loadtxt,这样的操作固然方便，但是代价就是内存直接爆掉，还好这次的数据才500M，所以不推荐大家使用我这个方法，之后会加以改进（如果我会的话<img src="https://res.wx.qq.com/mpres/htmledition/images/icon/common/emotion_panel/emoji_wx/2_05.png?wxfrom=5&wx_lazy=1&wx_co=1" alt="图片">）</p>
<p>这里分享一段代码，来自慕课网bobby老师的实战课，如何使用生成器读取大文本文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#500G, 特殊 一行</span><br><span class="line">def myreadlines(f, newline):</span><br><span class="line">  buf = &quot;&quot;</span><br><span class="line">  while True:</span><br><span class="line">    while newline in buf:</span><br><span class="line">      pos = buf.index(newline)</span><br><span class="line">      yield buf[:pos]</span><br><span class="line">      buf = buf[pos + len(newline):]</span><br><span class="line">    chunk = f.read(4096)</span><br><span class="line"></span><br><span class="line">    if not chunk:</span><br><span class="line">      #说明已经读到了文件结尾</span><br><span class="line">      yield buf</span><br><span class="line">      break</span><br><span class="line">    buf += chunk</span><br><span class="line"></span><br><span class="line">with open(&quot;input.txt&quot;) as f:</span><br><span class="line">    for line in myreadlines(f, &quot;&#123;|&#125;&quot;):</span><br><span class="line">        print (line)</span><br></pre></td></tr></table></figure>

<h5 id="关于matplotlib-pyplot使用上的坑"><a href="#关于matplotlib-pyplot使用上的坑" class="headerlink" title="关于matplotlib.pyplot使用上的坑"></a>关于matplotlib.pyplot使用上的坑</h5><p>在可视化的时候，柱状图的标识是中文，在显示的时候直接显示的是方块，无法显示中文。如下：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/jqCHqBaKLl21avaTr2pnseFQuSE1pAZKAntiaGhakcGRv4TLI55yttx7fOaWibAArTHzm36x1yal3AZVUAAIq3icQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片">错误示范</p>
<p>处理方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">解决方式一：修改配置文件</span><br><span class="line">(1)找到matplotlibrc文件（搜索一下就可以找到了）</span><br><span class="line">(2)修改：font.serif和font.sans-serif，我的在205,206行</span><br><span class="line">font.serif: SimHei, Bitstream Vera Serif, New Century Schoolbook, Century Schoolbook L, Utopia, ITC Bookman, Bookman, Nimbus Roman No9 L, Times New Roman, Times, Palatino, Charter, serif Bookman, Nimbus Roman No9 L, Times New Roman, Times, Palatino, Charter, serif</span><br><span class="line">font.sans-serif: SimHei, Bitstream Vera Sans, Lucida Grande, Verdana, Geneva, Lucid, Arial, Helvetica, Avant Garde, sans-serif</span><br><span class="line"></span><br><span class="line">解决方式二：在代码中修改</span><br><span class="line">import matplotlib</span><br><span class="line"></span><br><span class="line">指定默认字体</span><br><span class="line">matplotlib.rcParams[‘font.sans-serif’] = [‘SimHei’]</span><br><span class="line">matplotlib.rcParams[‘font.family’]=’sans-serif’</span><br><span class="line"></span><br><span class="line">解决负号’-‘显示为方块的问题</span><br><span class="line">matplotlib.rcParams[‘axes.unicode_minus’] = False</span><br><span class="line">---------------------</span><br><span class="line">来源：CSDN</span><br><span class="line">原文：https://blog.csdn.net/weixin_40283480/article/details/81613008</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://kokomisukisuki.github.io">sagonimikakokomi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://kokomisukisuki.github.io/2023/10/10/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%20%20Numpy%E5%AE%9E%E6%88%98(%E4%B8%80)%20-%20%E5%88%86%E6%9E%90%E6%9F%90%E5%8D%95%E8%BD%A6%E9%AA%91%E8%A1%8C%E6%97%B6%E9%97%B4/">https://kokomisukisuki.github.io/2023/10/10/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%20%20Numpy%E5%AE%9E%E6%88%98(%E4%B8%80)%20-%20%E5%88%86%E6%9E%90%E6%9F%90%E5%8D%95%E8%BD%A6%E9%AA%91%E8%A1%8C%E6%97%B6%E9%97%B4/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://kokomisukisuki.github.io" target="_blank">Hello</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a></div><div class="post_share"><div class="social-share" data-image="https://www.helloimg.com/images/2023/10/03/oHxEPE.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/10/10/%E5%B8%B8%E7%94%A8/" title="日常主流常用网站集合"><img class="cover" src="https://www.helloimg.com/images/2023/10/03/oHJyqP.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">日常主流常用网站集合</div></div></a></div><div class="next-post pull-right"><a href="/2023/10/10/%E7%BE%8E%E4%B9%8B%E5%9B%BEjs%E9%80%86%E5%90%91/" title="美之图js逆向"><img class="cover" src="https://www.helloimg.com/images/2023/10/03/oHxqUv.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">美之图js逆向</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/10/12/PyStata%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0.%E5%9F%8E%E5%B8%82%E7%BE%A4%E8%A7%86%E8%A7%92%E4%B8%8B%E7%9A%84%E4%BA%A7%E4%B8%9A%E5%85%B1%E8%81%9A%E4%B8%8E%E4%BA%A7%E4%B8%9A%E7%A9%BA%E9%97%B4%E6%B2%BB%E7%90%86%EF%BC%9A%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95%E7%9A%84%E6%B5%8B%E5%BA%A6/" title="PyStata论文复现|.城市群视角下的产业共聚与产业空间治理：机器学习算法的测度"><img class="cover" src="https://www.helloimg.com/images/2023/10/03/oHxEPE.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-12</div><div class="title">PyStata论文复现|.城市群视角下的产业共聚与产业空间治理：机器学习算法的测度</div></div></a></div><div><a href="/2023/10/12/Python%E9%87%8F%E5%8C%96%20%20%E6%9E%84%E5%BB%BA%E9%A9%AC%E7%A7%91%E7%BB%B4%E8%8C%A8%E6%9C%89%E6%95%88%E8%BE%B9%E7%95%8C/" title="Python量化 | 构建马科维茨有效边界"><img class="cover" src="https://www.helloimg.com/images/2023/10/03/oHxEPE.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-12</div><div class="title">Python量化 | 构建马科维茨有效边界</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://ooo.0x0.ooo/2023/10/02/OnIWmL.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">sagonimikakokomi</div><div class="author-info__description">none</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">124</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90-Numpy%E5%AE%9E%E6%88%98-%E4%B8%80-%E5%88%86%E6%9E%90%E6%9F%90%E5%8D%95%E8%BD%A6%E9%AA%91%E8%A1%8C%E6%97%B6%E9%97%B4"><span class="toc-text">数据分析 | Numpy实战(一) - 分析某单车骑行时间</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF%E6%95%B4%E7%90%86"><span class="toc-text">思路整理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%88%98"><span class="toc-text">实战</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E7%9B%AE%E7%9A%84"><span class="toc-text">分析目的</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%94%B6%E9%9B%86"><span class="toc-text">数据收集</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97"><span class="toc-text">数据清洗</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="toc-text">数据分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA"><span class="toc-text">结果展示</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%88%90%E6%9E%9C%E5%B1%95%E7%A4%BA"><span class="toc-text">成果展示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E8%B8%A9%E8%BF%87%E7%9A%84%E5%9D%91"><span class="toc-text">一些踩过的坑</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96-%E4%B8%80"><span class="toc-text">关于数据读取(一)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96%E4%B8%8A%E7%9A%84%E5%9D%91%EF%BC%88%E4%BA%8C%EF%BC%89"><span class="toc-text">关于数据读取上的坑（二）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E4%BA%8Ematplotlib-pyplot%E4%BD%BF%E7%94%A8%E4%B8%8A%E7%9A%84%E5%9D%91"><span class="toc-text">关于matplotlib.pyplot使用上的坑</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/10/12/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91%E5%8F%B2%E4%B8%8A%E6%9C%80%E5%85%A8%20Python%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%81/" title="无题"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2023/10/12/%E3%80%90%E6%BA%90%E7%A0%81%E3%80%91%E5%8F%B2%E4%B8%8A%E6%9C%80%E5%85%A8%20Python%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%EF%BC%81/" title="无题">无题</a><time datetime="2023-10-12T09:43:32.772Z" title="发表于 2023-10-12 17:43:32">2023-10-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/12/%E7%A7%92%E6%87%82Python%E7%BC%96%E7%A8%8B%E4%B8%AD%E7%9A%84if%20name%20==%20'main'%20%E7%9A%84%E4%BD%9C%E7%94%A8%E5%92%8C%E5%8E%9F%E7%90%86%EF%BC%81/" title="无题"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2023/10/12/%E7%A7%92%E6%87%82Python%E7%BC%96%E7%A8%8B%E4%B8%AD%E7%9A%84if%20name%20==%20'main'%20%E7%9A%84%E4%BD%9C%E7%94%A8%E5%92%8C%E5%8E%9F%E7%90%86%EF%BC%81/" title="无题">无题</a><time datetime="2023-10-12T09:41:46.741Z" title="发表于 2023-10-12 17:41:46">2023-10-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/12/%E3%80%90%E6%94%B6%E8%97%8F%E3%80%91Python%20%E5%AE%9E%E7%8E%B0%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E7%9A%84%E5%85%AB%E7%A7%8D%E6%96%B9%E6%A1%88%EF%BC%81/" title="无题"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2023/10/12/%E3%80%90%E6%94%B6%E8%97%8F%E3%80%91Python%20%E5%AE%9E%E7%8E%B0%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E7%9A%84%E5%85%AB%E7%A7%8D%E6%96%B9%E6%A1%88%EF%BC%81/" title="无题">无题</a><time datetime="2023-10-12T09:28:10.054Z" title="发表于 2023-10-12 17:28:10">2023-10-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/12/%E3%80%90%E5%B9%B2%E8%B4%A7%E3%80%91%E4%B8%80%E6%96%87%E8%AF%A6%E8%A7%A3Python%E5%A4%9A%E7%BA%BF%E7%A8%8B%E3%80%81%E5%A4%9A%E8%BF%9B%E7%A8%8B%EF%BC%81/" title="无题"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2023/10/12/%E3%80%90%E5%B9%B2%E8%B4%A7%E3%80%91%E4%B8%80%E6%96%87%E8%AF%A6%E8%A7%A3Python%E5%A4%9A%E7%BA%BF%E7%A8%8B%E3%80%81%E5%A4%9A%E8%BF%9B%E7%A8%8B%EF%BC%81/" title="无题">无题</a><time datetime="2023-10-12T09:24:41.638Z" title="发表于 2023-10-12 17:24:41">2023-10-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/12/PyStata%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0.%E5%9F%8E%E5%B8%82%E7%BE%A4%E8%A7%86%E8%A7%92%E4%B8%8B%E7%9A%84%E4%BA%A7%E4%B8%9A%E5%85%B1%E8%81%9A%E4%B8%8E%E4%BA%A7%E4%B8%9A%E7%A9%BA%E9%97%B4%E6%B2%BB%E7%90%86%EF%BC%9A%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95%E7%9A%84%E6%B5%8B%E5%BA%A6/" title="PyStata论文复现|.城市群视角下的产业共聚与产业空间治理：机器学习算法的测度"><img src="https://www.helloimg.com/images/2023/10/03/oHxEPE.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PyStata论文复现|.城市群视角下的产业共聚与产业空间治理：机器学习算法的测度"/></a><div class="content"><a class="title" href="/2023/10/12/PyStata%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0.%E5%9F%8E%E5%B8%82%E7%BE%A4%E8%A7%86%E8%A7%92%E4%B8%8B%E7%9A%84%E4%BA%A7%E4%B8%9A%E5%85%B1%E8%81%9A%E4%B8%8E%E4%BA%A7%E4%B8%9A%E7%A9%BA%E9%97%B4%E6%B2%BB%E7%90%86%EF%BC%9A%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95%E7%9A%84%E6%B5%8B%E5%BA%A6/" title="PyStata论文复现|.城市群视角下的产业共聚与产业空间治理：机器学习算法的测度">PyStata论文复现|.城市群视角下的产业共聚与产业空间治理：机器学习算法的测度</a><time datetime="2023-10-11T16:00:00.000Z" title="发表于 2023-10-12 00:00:00">2023-10-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By sagonimikakokomi</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">welcome</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div></body></html>